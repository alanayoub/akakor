'use strict';

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _electronCompile = require('electron-compile');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function findPackageJson(initScript) {
  if (initScript === '/' || initScript.match(/^[A-Za-z]:$/)) {
    throw new Error("Can't find package.json");
  }

  // Walk up the parent directories until we find package.json. Make sure that
  // we're not actually stumbling upon a parent npm package
  let ret = _path2.default.join(initScript, 'package.json');
  if (_fs2.default.statSyncNoException(ret) && !_path2.default.resolve(_path2.default.dirname(ret), '..').match(/[\\\/]node_modules$/i)) {
    return ret;
  }

  return findPackageJson(_path2.default.dirname(initScript));
}

function main() {
  let initScript = _path2.default.resolve(process.argv[2]);
  let packageJson = findPackageJson(initScript);

  // Reconstitute the original arguments
  let args = process.argv.slice(2);
  process.argv = [process.argv[0]].concat(args);

  (0, _electronCompile.init)(_path2.default.dirname(packageJson), initScript);
}

main();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lczYtaW5pdC5qcyJdLCJuYW1lcyI6WyJmaW5kUGFja2FnZUpzb24iLCJpbml0U2NyaXB0IiwibWF0Y2giLCJFcnJvciIsInJldCIsImpvaW4iLCJzdGF0U3luY05vRXhjZXB0aW9uIiwicmVzb2x2ZSIsImRpcm5hbWUiLCJtYWluIiwicHJvY2VzcyIsImFyZ3YiLCJwYWNrYWdlSnNvbiIsImFyZ3MiLCJzbGljZSIsImNvbmNhdCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFFQSxTQUFTQSxlQUFULENBQXlCQyxVQUF6QixFQUFxQztBQUNuQyxNQUFJQSxlQUFlLEdBQWYsSUFBc0JBLFdBQVdDLEtBQVgsQ0FBaUIsYUFBakIsQ0FBMUIsRUFBMkQ7QUFDekQsVUFBTSxJQUFJQyxLQUFKLENBQVUseUJBQVYsQ0FBTjtBQUNEOztBQUVEO0FBQ0E7QUFDQSxNQUFJQyxNQUFNLGVBQUtDLElBQUwsQ0FBVUosVUFBVixFQUFzQixjQUF0QixDQUFWO0FBQ0EsTUFBSSxhQUFHSyxtQkFBSCxDQUF1QkYsR0FBdkIsS0FBK0IsQ0FBQyxlQUFLRyxPQUFMLENBQWEsZUFBS0MsT0FBTCxDQUFhSixHQUFiLENBQWIsRUFBZ0MsSUFBaEMsRUFBc0NGLEtBQXRDLENBQTRDLHNCQUE1QyxDQUFwQyxFQUF5RztBQUN2RyxXQUFPRSxHQUFQO0FBQ0Q7O0FBRUQsU0FBT0osZ0JBQWdCLGVBQUtRLE9BQUwsQ0FBYVAsVUFBYixDQUFoQixDQUFQO0FBQ0Q7O0FBRUQsU0FBU1EsSUFBVCxHQUFnQjtBQUNkLE1BQUlSLGFBQWEsZUFBS00sT0FBTCxDQUFhRyxRQUFRQyxJQUFSLENBQWEsQ0FBYixDQUFiLENBQWpCO0FBQ0EsTUFBSUMsY0FBY1osZ0JBQWdCQyxVQUFoQixDQUFsQjs7QUFFQTtBQUNBLE1BQUlZLE9BQU9ILFFBQVFDLElBQVIsQ0FBYUcsS0FBYixDQUFtQixDQUFuQixDQUFYO0FBQ0FKLFVBQVFDLElBQVIsR0FBZSxDQUFDRCxRQUFRQyxJQUFSLENBQWEsQ0FBYixDQUFELEVBQWtCSSxNQUFsQixDQUF5QkYsSUFBekIsQ0FBZjs7QUFFQSw2QkFBSyxlQUFLTCxPQUFMLENBQWFJLFdBQWIsQ0FBTCxFQUFnQ1gsVUFBaEM7QUFDRDs7QUFFRFEiLCJmaWxlIjoiZXM2LWluaXQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IHtpbml0fSBmcm9tICdlbGVjdHJvbi1jb21waWxlJztcclxuXHJcbmZ1bmN0aW9uIGZpbmRQYWNrYWdlSnNvbihpbml0U2NyaXB0KSB7XHJcbiAgaWYgKGluaXRTY3JpcHQgPT09ICcvJyB8fCBpbml0U2NyaXB0Lm1hdGNoKC9eW0EtWmEtel06JC8pKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBmaW5kIHBhY2thZ2UuanNvblwiKTtcclxuICB9XHJcblxyXG4gIC8vIFdhbGsgdXAgdGhlIHBhcmVudCBkaXJlY3RvcmllcyB1bnRpbCB3ZSBmaW5kIHBhY2thZ2UuanNvbi4gTWFrZSBzdXJlIHRoYXRcclxuICAvLyB3ZSdyZSBub3QgYWN0dWFsbHkgc3R1bWJsaW5nIHVwb24gYSBwYXJlbnQgbnBtIHBhY2thZ2VcclxuICBsZXQgcmV0ID0gcGF0aC5qb2luKGluaXRTY3JpcHQsICdwYWNrYWdlLmpzb24nKVxyXG4gIGlmIChmcy5zdGF0U3luY05vRXhjZXB0aW9uKHJldCkgJiYgIXBhdGgucmVzb2x2ZShwYXRoLmRpcm5hbWUocmV0KSwgJy4uJykubWF0Y2goL1tcXFxcXFwvXW5vZGVfbW9kdWxlcyQvaSkpIHtcclxuICAgIHJldHVybiByZXQ7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZmluZFBhY2thZ2VKc29uKHBhdGguZGlybmFtZShpbml0U2NyaXB0KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1haW4oKSB7XHJcbiAgbGV0IGluaXRTY3JpcHQgPSBwYXRoLnJlc29sdmUocHJvY2Vzcy5hcmd2WzJdKTtcclxuICBsZXQgcGFja2FnZUpzb24gPSBmaW5kUGFja2FnZUpzb24oaW5pdFNjcmlwdCk7XHJcblxyXG4gIC8vIFJlY29uc3RpdHV0ZSB0aGUgb3JpZ2luYWwgYXJndW1lbnRzXHJcbiAgbGV0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMik7XHJcbiAgcHJvY2Vzcy5hcmd2ID0gW3Byb2Nlc3MuYXJndlswXV0uY29uY2F0KGFyZ3MpO1xyXG4gIFxyXG4gIGluaXQocGF0aC5kaXJuYW1lKHBhY2thZ2VKc29uKSwgaW5pdFNjcmlwdClcclxufVxyXG5cclxubWFpbigpXHJcbiJdfQ==